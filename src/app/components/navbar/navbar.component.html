<header class="fixed top-0 left-0 right-0 z-[100] transition-all duration-500 py-4" [class.py-0]="isScrolled"
    [class.scrolled]="isScrolled" #topSection>

    <!-- Background backdrop for the whole header on scroll -->
    <div class="absolute inset-0 bg-transparent backdrop-blur-0 transition-all duration-500"
        [class.bg-[var(--bg-main)]/80]="isScrolled" [class.backdrop-blur-xl]="isScrolled" [class.border-b]="isScrolled"
        [class.border-[var(--accent)]/20]="isScrolled">
    </div>

    <nav class="mx-auto max-w-[1400px] w-[95%] rounded-full flex items-center justify-between gap-6 px-8 py-4 relative transition-all duration-500 border border-[var(--border)] shadow-2xl backdrop-blur-md"
        [class.bg-[var(--bg-elevated)]/60]="!isScrolled" [class.mt-4]="!isScrolled" [class.mt-0]="isScrolled"
        [class.rounded-none]="isScrolled" [class.w-full]="isScrolled" [class.max-w-none]="isScrolled"
        [class.px-[5%]]="isScrolled" [class.py-4]="isScrolled" [class.border-none]="isScrolled"
        [class.shadow-none]="isScrolled" [class.bg-[var(--bg-main)]/90]="isScrolled">

        <!-- Subtle Animated Shimmer -->
        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-shimmer pointer-events-none rounded-full"
            [class.rounded-none]="isScrolled">
        </div>

        <!-- Brand Logo - Minimal & Clean -->
        <a (click)="scrollToSection('home')" class="group cursor-pointer flex items-center gap-1 z-10"
            aria-label="Home">
            <span
                class="font-black text-2xl tracking-tighter text-[var(--text)] transition-colors group-hover:text-[var(--accent)]">
                Eslam<span
                    class="text-[var(--accent)] text-3xl leading-none group-hover:text-[var(--text)] transition-colors">.</span>
            </span>
        </a>

        <div class="flex items-center gap-8">
            <!-- Navigation Links with New Icons -->
            <ul
                class="hidden lg:flex items-center gap-2 list-none m-0 p-0 text-sm font-medium tracking-wide bg-[var(--bg-main)]/50 p-1 rounded-full border border-[var(--border)] backdrop-blur-sm">

                <li>
                    <a (click)="scrollToSection('about')"
                        class="nav-link-desktop cursor-pointer transition-all duration-300 px-6 py-3 rounded-full relative overflow-hidden group"
                        [class.text-white]="activeSection() === 'about'"
                        [class.text-[var(--text-muted)]]="activeSection() !== 'about'">

                        <!-- Active Pill Background -->
                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full"
                            [class.opacity-100]="activeSection() === 'about'"
                            [class.opacity-0]="activeSection() !== 'about'"
                            [class.scale-100]="activeSection() === 'about'"
                            [class.scale-90]="activeSection() !== 'about'"></div>

                        <!-- Hover Background -->
                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full opacity-0 group-hover:opacity-100"
                            [class.opacity-0]="activeSection() === 'about'"></div>

                        <span class="relative z-10 transition-colors group-hover:text-white">
                            Profile
                        </span>
                    </a>
                </li>

                <li>
                    <a (click)="scrollToSection('skills')"
                        class="nav-link-desktop cursor-pointer transition-all duration-300 px-6 py-3 rounded-full relative overflow-hidden group"
                        [class.text-white]="activeSection() === 'skills'"
                        [class.text-[var(--text-muted)]]="activeSection() !== 'skills'">

                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full"
                            [class.opacity-100]="activeSection() === 'skills'"
                            [class.opacity-0]="activeSection() !== 'skills'"
                            [class.scale-100]="activeSection() === 'skills'"
                            [class.scale-90]="activeSection() !== 'skills'"></div>

                        <!-- Hover Background -->
                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full opacity-0 group-hover:opacity-100"
                            [class.opacity-0]="activeSection() === 'skills'"></div>

                        <span class="relative z-10 transition-colors group-hover:text-white">
                            Expertise
                        </span>
                    </a>
                </li>

                <li>
                    <a (click)="scrollToSection('projects')"
                        class="nav-link-desktop cursor-pointer transition-all duration-300 px-6 py-3 rounded-full relative overflow-hidden group"
                        [class.text-white]="activeSection() === 'projects'"
                        [class.text-[var(--text-muted)]]="activeSection() !== 'projects'">

                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full"
                            [class.opacity-100]="activeSection() === 'projects'"
                            [class.opacity-0]="activeSection() !== 'projects'"
                            [class.scale-100]="activeSection() === 'projects'"
                            [class.scale-90]="activeSection() !== 'projects'"></div>

                        <!-- Hover Background -->
                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full opacity-0 group-hover:opacity-100"
                            [class.opacity-0]="activeSection() === 'projects'"></div>

                        <span class="relative z-10 transition-colors group-hover:text-white">
                            Projects
                        </span>
                    </a>
                </li>

                <li>
                    <a (click)="scrollToSection('contact')"
                        class="nav-link-desktop cursor-pointer transition-all duration-300 px-6 py-3 rounded-full relative overflow-hidden group"
                        [class.text-white]="activeSection() === 'contact'"
                        [class.text-[var(--text-muted)]]="activeSection() !== 'contact'">

                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full"
                            [class.opacity-100]="activeSection() === 'contact'"
                            [class.opacity-0]="activeSection() !== 'contact'"
                            [class.scale-100]="activeSection() === 'contact'"
                            [class.scale-90]="activeSection() !== 'contact'"></div>

                        <!-- Hover Background -->
                        <div class="absolute inset-0 bg-[var(--accent)] transition-all duration-300 origin-center rounded-full opacity-0 group-hover:opacity-100"
                            [class.opacity-0]="activeSection() === 'contact'"></div>

                        <span class="relative z-10 transition-colors group-hover:text-white">
                            Contact
                        </span>
                    </a>
                </li>
            </ul>

            <!-- Action Buttons -->
            <div class="flex items-center gap-4">
                <!-- Theme Toggle with Enhanced Colors -->
                <button (click)="toggleTheme()"
                    class="w-11 h-11 md:w-12 md:h-12 rounded-full bg-[var(--bg-elevated)] border border-[var(--border)] flex items-center justify-center transition-all duration-300 hover:border-[var(--accent)] hover:text-[var(--accent)] transform hover:scale-110 active:scale-95 group shadow-lg"
                    [attr.aria-label]="isDark() ? 'Switch to light mode' : 'Switch to dark mode'">
                    <div class="transition-all duration-500 group-hover:rotate-[360deg] text-xl">
                        <i [class]="isDark() ? 'fas fa-sun text-yellow-400' : 'fas fa-moon text-blue-500'"></i>
                    </div>
                </button>

                <!-- Mobile Toggle -->
                <button
                    type="button"
                    class="w-11 h-11 md:w-12 md:h-12 rounded-xl bg-[#f59e0b] text-white flex items-center justify-center transition-all duration-300 transform hover:scale-110 active:scale-95 shadow-lg lg:hidden relative z-[200] cursor-pointer"
                    aria-label="Toggle navigation" 
                    (click)="toggleMenu()"
                    [attr.aria-expanded]="isMenuOpen">
                    <div class="tricky-burger relative pointer-events-none" [class.open]="isMenuOpen">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Backdrop -->
    <div *ngIf="isMenuOpen" 
         class="lg:hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[140] transition-opacity duration-300"
         (click)="closeMenu()">
    </div>

    <!-- Mobile Dropdown with Enhanced Colors -->
    <div class="lg:hidden fixed top-[5.5rem] left-[2.5%] w-[95%] rounded-[2.5rem] border border-[var(--border)] p-8 liquid-menu z-[150] bg-[var(--bg-elevated)]"
        [class.expand]="isMenuOpen"
        *ngIf="isMenuOpen">

        <!-- Animated Content Layer -->
        <ul class="flex flex-col gap-3 relative z-10">
            <li>
                <a (click)="scrollToSection('about')"
                    class="mobile-nav-link block px-6 py-5 rounded-2xl transition-all duration-300 transform cursor-pointer"
                    [class.bg-white]="activeSection() === 'about'"
                    [class.text-green-600]="activeSection() === 'about'"
                    [class.text-[var(--text)]]="activeSection() !== 'about'">
                    <span class="font-bold text-lg">Profile</span>
                </a>
            </li>
            <li>
                <a (click)="scrollToSection('skills')"
                    class="mobile-nav-link block px-6 py-5 rounded-2xl transition-all duration-300 transform cursor-pointer"
                    [class.bg-white]="activeSection() === 'skills'"
                    [class.text-green-600]="activeSection() === 'skills'"
                    [class.text-[var(--text)]]="activeSection() !== 'skills'">
                    <span class="font-bold text-lg">Expertise</span>
                </a>
            </li>
            <li>
                <a (click)="scrollToSection('projects')"
                    class="mobile-nav-link block px-6 py-5 rounded-2xl transition-all duration-300 transform cursor-pointer"
                    [class.bg-white]="activeSection() === 'projects'"
                    [class.text-green-600]="activeSection() === 'projects'"
                    [class.text-[var(--text)]]="activeSection() !== 'projects'">
                    <span class="font-bold text-lg">Projects</span>
                </a>
            </li>
            <li>
                <a (click)="scrollToSection('contact')"
                    class="mobile-nav-link block px-6 py-5 rounded-2xl transition-all duration-300 transform cursor-pointer"
                    [class.bg-white]="activeSection() === 'contact'"
                    [class.text-green-600]="activeSection() === 'contact'"
                    [class.text-[var(--text)]]="activeSection() !== 'contact'">
                    <span class="font-bold text-lg">Contact</span>
                </a>
            </li>
        </ul>
    </div>
</header>